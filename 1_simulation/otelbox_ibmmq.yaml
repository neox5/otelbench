iterators:
  - name: q
    type: range
    start: 1
    end: 2000

instances:
  sources:
    - name: src_int_{q}
      type: random_int
      clock:
        type: periodic
        interval: 1s
      min: 0
      max: 10

  values:
    - name: v_put_counter_{q}
      source:
        instance: src_int_{q}
      transforms: [accumulate]
      reset: on_read

    - name: v_get_counter_{q}
      source:
        instance: src_int_{q}
      transforms: [accumulate]
      reset: on_read

metrics:
  # Original counter metric (mimics decentral system - already sum)
  - name:
      prometheus: ibmmq_queue_mqput_mqput1_count_total
      otel: ibmmq.queue.mqput_mqput1_count
    type: gauge
    description: "Total MQ PUT operations since start"
    value:
      instance: v_put_counter_{q}
    attributes:
      queue: QUEUE_{q}

  # Rate gauge metric (mimics central system - gauge that needs conversion)
  - name:
      prometheus: ibmmq_queue_mqget_count_ratio
      otel: ibmmq.queue.mqget_count
    type: gauge
    description: "Recent MQ GET operations in window"
    value:
      instance: v_get_counter_{q}
    attributes:
      queue: QUEUE_{q}

export:
  otel:
    enabled: true
    host: otelcol
    interval: 5s
    resource:
      service.name: otelbox
      service.version: 0.1.0
      deployment.environment: development
